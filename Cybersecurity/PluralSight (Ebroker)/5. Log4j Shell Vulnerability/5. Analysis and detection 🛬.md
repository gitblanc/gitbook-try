- Stop suricata `screen -r suricata`, Ctrl +C
- ls ~/lab
![[suric.png]]
NOTES: 
- the stats.log is some internal statistics for Suricata

- Display the fast.log (disabling word wrap):
```
less -S ~/lab/fast.log
```
![[less.png]]
- Moving on to the eve.json file, this contains everything Suricata generates and pipe it into rthe tool **jq**, which makes json reading much simpler
```
cat ~/lab/eve.json | jq . | less
```
![[json.png]]
- If you just want to see the alerts type:
```
cat ~/lab/eve.json | jq 'select(.event_tyope == "alert")' | less
```
NOTES:
- Suricata will generate HTTP metadata like the hostname, user agent and methods. What you won't see here is the X-Api-Version field that we exploited before
![[http suricata.png]]
- Watch the conversation between the two hosts:
```
tcpdump -nn -r ~/analysis.pcap 'tcp por 8080' -vvv | less -S
```
- You can see the first conversation, followed by the next ones:
![[conv 1.png]]
- The second one with the malicious string:
![[conv 2.png]]
- Make a further search:
```
tcpdump -nn -r ~/analysis.pcap -vvv | grep jndi
```
![[jndi broad.png]]
- Analyze the 3rd conversation:
```
tcpdump -nn -r ~/analysis.pcap 'tcp por 1389' -vvv -X | less -S
```
![[conv 3.png]]
- Following that is the response
![[response 3.png]]
- Filter on port 8888 to see the follow on request:
```
tcpdump -nn -r ~/analysis.pcap 'tcp por 8888' -vvv -X | less -S
```
![[response 4.png]]
- Now we can see the command we attached:
![[command 4.png]]
- Now check the port of the reverse shell (7777):
```
tcpdump -nn -r ~/analysis.pcap 'tcp por 7777' -vvv -X | less -S
```
![[response 5.png]]
